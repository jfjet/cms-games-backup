<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="lib/bootstrap.min.css">
	<link rel="stylesheet" href="lib/bootstrap-theme.min.css">
	<link rel="stylesheet" href="lib/keys.css">
	<script src="lib/jquery-2.1.1.min.js"></script>
	<script src="lib/swfobject.js"></script>
	<script src="lib/bootstrap.min.js"></script>
	<style>
		body { margin: 0; background-color: #eee;}
		aside { position: fixed; left: 0; width: 300px; top: 0; bottom: 0; background-color: #fff; padding: 10px; overflow: auto; border-right: 1px solid #ccc;}
		aside a { cursor: pointer; line-height: 25px;}
		#help { text-align: center; color: #666;}
		#emulatorbox { text-align: center; margin: 10px auto;}
		main { position: fixed; left: 300px; top: 0; bottom: 0; right: 0;}
		#table { width: 100%; height: 100%;}
		#rom img { width: 25px; height: 25px; margin-right: 2px; }
		.separator { margin-right: 10px;}
	</style>
</head>
<body>
	<div id="background"></div>
	<aside>
		<ul id="rom" class="nav nav-pills nav-stacked">
			<li>
				<a data-ver="5.0" data-rom="pong.gbc" data-system="gb">
					<img src="roms/pong.png"> 5.0 Pong
				</a>
			</li>
			<li>
				<a data-ver="5.1" data-rom="tetris.sfc" data-system="snes">
					<img src="roms/tetris.jpg"> 5.1 Tetris
				</a>
			</li>
			<li>
				<a data-ver="5.2" data-rom="prince.sfc" data-system="snes">
					<img src="roms/prince.jpg"> 5.2 Prince of Persia
				</a>
			</li>
			<li>
				<a data-ver="5.3" data-rom="asteroids.gbc" data-system="gb">
					<img src="roms/asteroids.png"> 5.3 Asteroids
				</a>
			</li>
			<li>
				<a data-ver="5.4" data-rom="pacman.nes" data-system="nes">
					<img src="roms/pacman.png"> 5.4 Pac-Man
				</a>
			</li>
			<li>
				<a data-ver="5.5" data-rom="ducktales.nes" data-system="nes">
					<img src="roms/ducktales.jpg"> 5.5 Duck Tales
				</a>
			</li>
			<li>
				<a data-ver="5.6" data-rom="contra.nes" data-system="nes">
					<img src="roms/contra.gif"> 5.6 Contra
				</a>
			</li>
			<li>
				<a data-ver="5.7" data-rom="tecmobowl.nes" data-system="nes">
					<img src="roms/Tecmosuperbowl-70px.jpg"> 5.7 Tecmo Bowl
				</a>
			</li>
		</ul>
	</aside>
	<main>
		<table id="table">
		<tbody>
		<tr>
			<td>
				<div id="emulatorbox">
					<div id="emulator"></div>
				</div>
				<div id="help">
					<kbd class="light">Left</kbd> <kbd class="light">Right</kbd> <kbd class="light">Up</kbd> <kbd class="light">Down</kbd> to move
					<span class="separator"></span>
					<kbd class="light">Z</kbd> <kbd class="light">X</kbd> <kbd class="light">C</kbd> <kbd class="light">A</kbd> <kbd class="light">S</kbd> <kbd class="light">D</kbd> for buttons
					<span class="separator"></span>
					<kbd class="light">Enter</kbd> for start <kbd class="light">Space</kbd> for select
				</div>
			</td>
		</tr>
		</tbody>
		</table>
		</div>
	</main>
	<script>
		$('aside .nav > li > a').click(function() {
			$('aside .nav > li').removeClass('active');
			$(this).closest('li').addClass('active');
			start();
		})
		var resizeOwnEmulator = function(width, height){
			var emulator = $('#emulator');
			emulator.css('width', width);
			emulator.css('height', height);
		}
		function start() {
			var rom = 'roms/' + $('#rom .active a').attr('data-rom');
			var system = $('#rom .active a').attr('data-system');
			var emulatorbox = $('#emulatorbox');
			var flashvars = {
				system : system,
				url : rom
			};
			var params = {};
			var attributes = {};
			params.allowscriptaccess = 'sameDomain';
			params.allowFullScreen = 'true';
			params.allowFullScreenInteractive = 'true';
			swfobject.embedSWF('flash/Nesbox.swf', 'emulator', '100%', '100%', '11.2.0', 'flash/expressInstall.swf', flashvars, params, attributes);
		}
		
		$.urlParam = function(name){
			var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
			if (results==null)
				return ''
			else
				return results[1] || 0;
		}
		var ver = $.urlParam('ver').replace(/^(\d+\.\d+)(.*)$/,'$1');
		$('a[data-ver="'+ver+'"]').click()
	</script>
</body>
</html>